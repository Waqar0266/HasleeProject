@model Hasslefree.Web.Models.Rentals.CompleteRentalAgent

<div class="clearfix"></div>
<div id="content">
	<div class="container">
		<div class="row justify-content-md-center">
			<div class="col col-lg-12 col-xl-12">
				<div class="row">

					<div class="col-md-12 col-lg-12 col-xl-12">
						<div class="page-header bordered">
							<h1>Complete Rental <small>Complete your rental listing</small></h1>
						</div>
						<form action="/account/rental/a/complete" method="post" id="rental-form">
							@Html.HiddenFor(m => m.RentalGuid)
							@Html.HiddenFor(m => m.AgentGuid)
							@{
								if (ViewData.ModelState.Any(m => m.Value.Errors.Count > 0))
								{
									<div class="alert alert-danger" role="alert">
										@Html.ValidationSummary(false)
									</div>
								}
							}
							@Html.AntiForgeryToken()

							<h3 class="subheadline">Your Information</h3>
							<div class="form-group">
								<label for="Name">VAT Registration Number</label>
								@Html.TextBoxFor(m => m.VatNumber, new { @class = "form-control", @placeholder = "VAT Registration Number" })
							</div>
							<div class="form-group">
								<label for="Surname">Fidelity Fund Certificate Number (FFC)</label>
								@Html.TextBoxFor(m => m.FfcNumber, new { @class = "form-control", @placeholder = "Fidelity Fund Certificate Number (FFC)" })
							</div>

							<h3 class="subheadline">Listing Information</h3>
							<div class="form-group">
								<label for="Premises">The Premises</label>
								@Html.TextBoxFor(m => m.Premises, new { @class = "form-control", @placeholder = "The Premises" })
							</div>
							<div class="form-group">
								<label for="StandErf">Stand/Erf</label>
								@Html.TextBoxFor(m => m.StandErf, new { @class = "form-control", @placeholder = "Stand/Erf" })
							</div>
							<div class="form-group">
								<label for="Township">Township</label>
								@Html.TextBoxFor(m => m.Township, new { @class = "form-control", @placeholder = "Township" })
							</div>
							<div class="form-group">
								<label for="Address">Being (street address)</label>
								@Html.TextBoxFor(m => m.Address, new { @class = "form-control", @placeholder = "Being (street address)" })
							</div>
							<h3 class="subheadline">Rental Information</h3>
							<div class="form-group">
								<label for="MonthlyRental">Monthly Rental</label>
								@Html.TextBox("MonthlyRental", String.Format("{0:0.00}", Model.MonthlyRental), new { id = "MonthlyRental", @class = "form-control", @placeholder = "Monthly Rental (R)" })
							</div>
							<div class="form-group">
								<label for="Deposit">Deposit</label>
								@Html.TextBox("Deposit", String.Format("{0:0.00}", Model.Deposit), new { id = "Deposit", @class = "form-control", @placeholder = "Deposit" })
							</div>
							<div class="form-group">
								<label for="PostalAddress1">Rental Payment Date</label>
								@Html.TextBoxFor(m => m.RentalPaymentDate, new { @class = "form-control", @placeholder = "Rental Payment Date" })
							</div>
							<div class="form-group">
								<label for="PostalAddress2">Deposit Payment Date</label>
								@Html.TextBoxFor(m => m.DepositPaymentDate, new { @class = "form-control", @placeholder = "Deposit Payment Date" })
							</div>

							<h3 class="subheadline">Commission</h3>
							<div class="form-group">
								<label for="Procurement1Percentage">Procurement Commission (excluding VAT) %</label>
								@Html.TextBox("Procurement1Percentage", String.Format("{0:0}", Model.Procurement1Percentage), new { id = "Procurement1Percentage", @class = "form-control", @placeholder = "Procurement Commission (excluding VAT) %" })
							</div>
							<div class="form-group">
								<label for="Procurement1Amount">Procurement Commission (excluding VAT) Amount</label>
								@Html.TextBox("Procurement1Amount", String.Format("{0:0}", Model.Procurement1Amount), new { id = "Procurement1Amount", @class = "form-control", @placeholder = "Procurement Commission (excluding VAT) Amount" })
							</div>
							<div class="form-group">
								<label for="Procurement2Percentage">Second Year's Procurement Commission (excluding VAT) %</label>
								@Html.TextBox("Procurement2Percentage", String.Format("{0:0}", Model.Procurement2Percentage), new { id = "Procurement2Percentage", @class = "form-control", placeholder = "Second Year's Procurement Commission (excluding VAT) %" })
							</div>
							<div class="form-group">
								<label for="Procurement2Amount">Second Year's Procurement Commission (excluding VAT) Amount</label>
								@Html.TextBox("Procurement2Amount", String.Format("{0:0}", Model.Procurement2Amount), new { id = "Procurement2Amount", @class = "form-control", placeholder = "Second Year's Procurement Commission (excluding VAT) Amount" })
							</div>
							<div class="form-group">
								<label for="Procurement3Percentage">Additional Year's Procurement Commission (excluding VAT) %</label>
								@Html.TextBox("Procurement3Percentage", String.Format("{0:0}", Model.Procurement3Percentage), new { id = "Procurement3Percentage", @class = "form-control", @placeholder = "Additional Year's Procurement Commission (excluding VAT) %" })
							</div>
							<div class="form-group">
								<label for="Procurement3Amount">Additional Year's Procurement Commission (excluding VAT) Amount</label>
								@Html.TextBox("Procurement3Amount", String.Format("{0:0}", Model.Procurement3Amount), new { id = "Procurement3Amount", @class = "form-control", @placeholder = "Additional Year's Procurement Commission (excluding VAT) Amount" })
							</div>
							<div class="form-group">
								<label for="ManagementPercentage">Management Commission (excluding VAT) %</label>
								@Html.TextBox("ManagementPercentage", String.Format("{0:0}", Model.ManagementPercentage), new { id = "ManagementPercentage", @class = "form-control", @placeholder = "Management Commission (excluding VAT) %" })
							</div>
							<div class="form-group">
								<label for="ManagementAmount">Management Commission (excluding VAT) Amount</label>
								@Html.TextBox("ManagementAmount", String.Format("{0:0}", Model.ManagementAmount), new { id = "ManagementAmount", @class = "form-control", @placeholder = "Management Commission (excluding VAT) Amount" })
							</div>
							<div class="form-group">
								<label for="SalePercentage">Sale Commission (excluding VAT) %</label>
								@Html.TextBox("SalePercentage", String.Format("{0:0}", Model.SalePercentage), new { id = "SalePercentage", @class = "form-control", @placeholder = "Sale Commission (excluding VAT) %" })
							</div>
							<div class="form-group">
								<label for="SaleAmount">Sale Commission (excluding VAT) Amount</label>
								@Html.TextBox("SaleAmount", String.Format("{0:0}", Model.SaleAmount), new { id = "SaleAmount", @class = "form-control", @placeholder = "Sale Commission (excluding VAT) Amount" })
							</div>

							<h3 class="subheadline">Agent Duties</h3>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.Marketing ? "checked" : "") type="checkbox" id="marketing" />
									<label for="marketing">Has the Agent approached the Landlord by way of Direct Marketing?</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.Procurement ? "checked" : "") type="checkbox" id="procurement" />
									<label for="procurement">For the purpose of finding a Tenant only (Procurement)?</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.Management ? "checked" : "") type="checkbox" id="management" />
									<label for="management">For the purpose of managing any Tenant on the Premises (Management)?</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.Negotiating ? "checked" : "") type="checkbox" id="negotiating" />
									<label for="negotiating">
										Negotiating the Lease Agreement with potential Tenants and ensuring that all suspensive and resolutive legal formalities pertaining to the Lease Agreement are complied with?
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.Informing ? "checked" : "") type="checkbox" id="informing" />
									<label for="informing">
										Informing the Tenant of all rights and duties in terms of the Lease Agreement including the Tenant’s duties to pay the Rental on time and to look after the Premises
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.IncomingSnaglist ? "checked" : "") type="checkbox" id="incoming-snaglist" />
									<label for="incoming-snaglist">
										Initiating and performing the incoming snag list or initial inspection of the Premises and recording all existing damages or defects to the Premises
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.OutgoingSnaglist ? "checked" : "") type="checkbox" id="outgoing-snaglist" />
									<label for="outgoing-snaglist">
										Initiating and performing the outgoing snag list or exit inspection of the Premises and recording all damages and defects to the Premises
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.Explaining ? "checked" : "") type="checkbox" id="explaining" />
									<label for="explaining">
										Explaining to the Tenant that the Tenant may be asked by the Agent to pay a portion of the Rental directly to the Agent if the Landlord does not pay the Agent a portion or the full amount of any Commission due to the Agent
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.PayingLandlord ? "checked" : "") type="checkbox" id="paying-landlord" />
									<label for="paying-landlord">
										Paying the Landlord to his Nominated Bank Account as set out in item 1.8 by the date referred to in item 1.4, all Rental and ancillary expenses payable by the Tenant, as well as VAT thereon
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.ContactLandlord ? "checked" : "") type="checkbox" id="contact-landlord" />
									<label for="contact-landlord">
										The Agent will prior to instructing the attorneys contact the Landlord and inform him of the legal situation
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.ProvideLandlord ? "checked" : "") type="checkbox" id="provide-landlord" />
									<label for="provide-landlord">
										The Agent will prior to instructing the attorneys provide the Landlord with the contact details of the preferred attorney
									</label>
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.AskLandlordConsent ? "checked" : "") type="checkbox" id="ask-landlord-consent" />
									<label for="ask-landlord-consent">
										The Agent will prior to instructing the attorneys ask the Landlord for consent to refer the matter to the attorney in question
									</label>
								</div>
							</div>
							<div class="form-group">
								<label>The Agent shall procure the Deposit from the:</label>
								<div>
									<div class="radio radio-inline">
										<input @(Model.ProcureDepositLandlord ? "checked" : "") type="radio" name="DepositProcurement" id="procure-deposit-landlord" value="Landlord">
										<label for="procure-deposit-landlord">Landlord</label>
									</div>
									<div class="radio radio-inline">
										<input @(Model.ProcureDepositPreviousRentalAgent ? "checked" : "") type="radio" name="DepositProcurement" id="procure-deposit-previous-rental-agent" value="PreviousRentalAgent">
										<label for="procure-deposit-previous-rental-agent">Previous Rental Agent</label>
									</div>
									<div class="radio radio-inline">
										<input @(String.IsNullOrEmpty(Model.ProcureDepositOther) ? "" : "checked") type="radio" name="DepositProcurement" id="procure-deposit-other" value="Other">
										<label for="procure-deposit-other">Another third party (specify)</label>
									</div>
								</div>
								<div id="procure-deposit-other-specify" style="display:@(String.IsNullOrEmpty(Model.ProcureDepositOther) ? "none" : "inline-block");">
									<label for="ProcureDepositOther">Specify</label>
									@Html.TextBoxFor(m => m.ProcureDepositOther, new { @class = "form-control", @placeholder = "Specify" })
								</div>
							</div>
							<div class="form-group">
								<div class="checkbox">
									<input @(Model.TransferDeposit ? "checked" : "") type="checkbox" id="transfer-deposit" />
									<label for="transfer-deposit">
										The Agent shall after procuring the Deposit transfer the Deposit to its Trust Account
									</label>
								</div>
							</div>

							<h3 class="subheadline">Other Conditions</h3>
							<div class="form-group">
								<label for="SpecificRequirements">Specific Requirements</label>
								@Html.TextAreaFor(m => m.SpecificRequirements, new { @class = "form-control", @placeholder = "Specific Requirements", rows = 7 })
							</div>
							<div class="form-group">
								<label for="SpecialConditions">Special Conditions</label>
								@Html.TextAreaFor(m => m.SpecialConditions, new { @class = "form-control", @placeholder = "Special Conditions", rows = 7 })
							</div>

							<h3 class="subheadline">Witness 1 Details</h3>
							<div class="form-group">
								<label for="Name">Name</label>
								@Html.TextBoxFor(m => m.Witness1Name, new { @class = "form-control", @placeholder = "Name" })
							</div>
							<div class="form-group">
								<label for="Name">Surname</label>
								@Html.TextBoxFor(m => m.Witness1Surname, new { @class = "form-control", @placeholder = "Surname" })
							</div>
							<div class="form-group">
								<label for="Name">Email</label>
								@Html.TextBoxFor(m => m.Witness1Email, new { @class = "form-control", @placeholder = "Email" })
							</div>
							<div class="form-group">
								<label for="Name">Mobile</label>
								@Html.TextBoxFor(m => m.Witness1Mobile, new { @class = "form-control", @placeholder = "Mobile" })
							</div>

							<h3 class="subheadline">Witness 2 Details</h3>
							<div class="form-group">
								<label for="Name">Name</label>
								@Html.TextBoxFor(m => m.Witness2Name, new { @class = "form-control", @placeholder = "Name" })
							</div>
							<div class="form-group">
								<label for="Name">Surname</label>
								@Html.TextBoxFor(m => m.Witness2Surname, new { @class = "form-control", @placeholder = "Surname" })
							</div>
							<div class="form-group">
								<label for="Name">Email</label>
								@Html.TextBoxFor(m => m.Witness2Email, new { @class = "form-control", @placeholder = "Email" })
							</div>
							<div class="form-group">
								<label for="Name">Mobile</label>
								@Html.TextBoxFor(m => m.Witness2Mobile, new { @class = "form-control", @placeholder = "Mobile" })
							</div>
							<hr>
							<div class="form-group action">
								<button type="submit" class="btn btn-lg btn-primary" data-loading-text="<i class='fa fa-spinner fa-spin'></i> Saving...">Continue</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

@section PageScripts{

	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6QjJKeDXiflZEJug5ldkvAzzrLkZYoAM&libraries=places&callback=initMap" async></script>

	<script type="text/javascript">

		function initMap() {
			const address = document.getElementById("Address");
			const addressOptions = {
				componentRestrictions: { country: "za" },
				types: ["address"]
			};
			const addressAutocomplete = new google.maps.places.Autocomplete(address, addressOptions);
			addressAutocomplete.addListener("place_changed", () => {
				const place = addressAutocomplete.getPlace();
				console.log(place);
				$('#Address').val(place.formatted_address);
			});
		}

		$(document).ready(function () {

			$("#Address").on('focus', function () {
				var r = Math.floor(Math.random() * 100);
				$(this).attr('autocomplete', 'disable-autofill');
			});

			$('#RentalPaymentDate').datetimepicker({
				timepicker: false,
				format: 'Y/m/d',
				value: '@Model.RentalPaymentDate.Value.ToString("yyyy-MM-dd")'
			});

			$('#DepositPaymentDate').datetimepicker({
				timepicker: false,
				format: 'Y/m/d',
				value: '@Model.DepositPaymentDate.Value.ToString("yyyy-MM-dd")'
			});

			$('[name="DepositProcurement"]').on('change', function () {

				var value = $(this).val();
				$('#ProcureDepositOther').val('');
				if (value == 'Landlord' || value == 'PreviousRentalAgent') {
					$('#procure-deposit-other-specify').hide('fast');
				}
				else {
					$('#procure-deposit-other-specify').show('fast');
				}
			});

		})

		$('#rental-form').on('submit', function () {

			if (!Hasslefree.Functions.Validate(this)) return false;

			$('#rental-form').append('<input type="hidden" name="Procurement" value="' + $('#procurement').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="Management" value="' + $('#management').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="Negotiating" value="' + $('#negotiating').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="Informing" value="' + $('#informing').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="IncomingSnaglist" value="' + $('#incoming-snaglist').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="OutgoingSnaglist" value="' + $('#outgoing-snaglist').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="Explaining" value="' + $('#explaining').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="PayingLandlord" value="' + $('#paying-landlord').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="InstructingAttorneys" value="' + $('#instruct-landlord').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="ContactLandlord" value="' + $('#contact-landlord').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="ProvideLandlord" value="' + $('#provide-landlord').is(':checked') + '" />');
			$('#rental-form').append('<input type="hidden" name="AskLandlordConsent" value="' + $('#ask-landlord-consent').is(':checked') + '" />');

			$('#rental-form').append('<input type="hidden" name="ProcureDepositLandlord" value="' + ($('[name="DepositProcurement"]:checked').val() == 'Landlord') + '" />');
			$('#rental-form').append('<input type="hidden" name="ProcureDepositPreviousRentalAgent" value="' + ($('[name="DepositProcurement"]:checked').val() == 'PreviousRentalAgent') + '" />');

			$('#rental-form').append('<input type="hidden" name="TransferDeposit" value="' + $('#transfer-deposit').is(':checked') + '" />');

		});

		$('#Race').on('change', function () {
			var selected = $(this).val();
			if (selected == 'Other') {
				$('#race-other').val('');
				$('#race-other-container').show('fast');
				$('#Race').removeAttr('name');
				$('#race-other').attr('name', 'Race');
			}
			else {
				$('#race-other').val('');
				$('#race-other-container').hide('fast');
				$('#race-other').removeAttr('name');
				$('#Race').attr('name', 'Race');
			}
		});

		$('#nationality').on('change', function () {
			var checked = $(this).is(':checked');
			if (!checked) {
				$('#nationality-other').val('');
				$('#nationality-other-container').show('fast');
			}
			else {
				$('#nationality-other').val('South African');
				$('#nationality-other-container').hide('fast');
			}
		});

		$('#ffc').on('change', function () {
			var checked = $(this).is(':checked');
			if (checked) {
				$('#FfcNumber').val('');
				$('#ffc-container').show('fast', function () {
					$('#FfcIssueDate').datetimepicker({
						timepicker: false,
						format: 'Y/m/d'
					});
				});

			}
			else {
				$('#FfcNumber').val('');
				$('#ffc-container').hide('fast');
				$('#FfcIssueDate').datetimepicker('destroy');
			}
		});

	</script>

}